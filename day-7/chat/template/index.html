<!DOCTYPE html>
<html>
<head>
    <title>Chatbot Demo</title>
</head>
<body>
    <h1>Chatbot Demo</h1>

    <div class="chatbox-container">
        <div class="chatbox-header">Chat</div>
        <div class="chatbox-body">
          <div class="chatbox-message">Welcome to our restaurant! How can we assist you today?</div>
          <!-- Other chat messages will be dynamically added here -->
        </div>
        <div class="chatbox-input">
          <input type="text" id="chatInput" placeholder="Type your message..." />
          <button id="sendButton">Send</button>
        </div>
      </div>

</body>
</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js" integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA==" crossorigin="anonymous"></script>
  <script type="text/javascript" charset="utf-8">
    var socket = io('http://localhost:5000');

    socket.on('connect', function () {
      const additionalData = {
        token: localStorage.getItem("userId")
      };
      socket.emit('connect_with_details', additionalData);
    });

    // Chatbox functionality
    var chatboxBody = document.querySelector(".chatbox-body");
    var chatInput = document.getElementById("chatInput");
    var sendButton = document.getElementById("sendButton");
    var chat = []

    sendButton.addEventListener("click", sendMessage);

    function sendMessage() {
      var message = chatInput.value;
      if (message.trim() !== "") {
        var chatboxMessage = document.createElement("div");
        chatboxMessage.className = "chatbox-message";
        chatboxMessage.textContent = message;
        chatboxBody.appendChild(chatboxMessage);
        socket.emit('gpt', {"input": message, "chat": chat});
        chatInput.value = "";
        chatboxBody.scrollTop = chatboxBody.scrollHeight;
      }
    }

    socket.on("gpt", (data)=>{
      console.log(data)
      var chatboxMessage = document.createElement("div");
      chatboxMessage.className = "chatbox-message";
      chatboxMessage.textContent = data.answer.content;
      chatboxBody.appendChild(chatboxMessage);
      chat = data.chat
      chatboxBody.scrollTop = chatboxBody.scrollHeight;
    })
  </script>